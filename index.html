<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar Study Buddy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            backdrop-filter: blur(16px) saturate(180%);
            background-color: rgba(255, 255, 255, 0.75);
            border: 1px solid rgba(209, 213, 219, 0.3);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <div id="app" class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-white mb-2">Grammar Study Buddy</h1>
            <p class="text-white/80 text-lg">Get instant grammar feedback on your sentences</p>
        </div>

        <!-- Main Card -->
        <div class="max-w-4xl mx-auto">
            <div class="glass-effect rounded-2xl p-8 shadow-2xl">
                <!-- Input Section -->
                <div class="mb-8">
                    <label for="sentence" class="block text-gray-700 font-semibold mb-3 text-lg">
                        Enter your sentence:
                    </label>
                    <textarea
                        id="sentence"
                        v-model="inputSentence"
                        placeholder="Type your sentence here..."
                        class="w-full p-4 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200 resize-none"
                        rows="3"
                        :disabled="isLoading"
                    ></textarea>
                    
                    <!-- API Key Input -->
                    <div class="mt-4">
                        <label for="apiKey" class="block text-gray-700 font-semibold mb-2">
                            OpenRouter API Key:
                        </label>
                        <input
                            id="apiKey"
                            v-model="apiKey"
                            type="password"
                            placeholder="Enter your OpenRouter API key here"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
                            class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all duration-200"
                            :disabled="isLoading"
                        >
                        <p class="text-sm text-gray-600 mt-1">
                            Get your API key from <a href="https://openrouter.ai/keys" target="_blank" class="text-blue-600 hover:underline">OpenRouter</a>
                        </p>
                    </div>

                    <!-- Submit Button -->
                    <button
                        @click="checkGrammar"
                        :disabled="!inputSentence.trim() || !apiKey.trim() || isLoading"
                        class="mt-4 w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2"
                    >
                        <span v-if="isLoading" class="animate-spin">‚è≥</span>
                        <span v-else>üîç</span>
                        {{ isLoading ? 'Checking Grammar...' : 'Check Grammar' }}
                    </button>
                </div>

                <!-- Results Section -->
                <div v-if="result" class="space-y-4">
                    <!-- Grammar Status -->
                    <div class="p-6 rounded-lg border-2" :class="result.isCorrect ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'">
                        <div class="flex items-center gap-3 mb-3">
                            <span class="text-2xl">{{ result.isCorrect ? '‚úÖ' : '‚ùå' }}</span>
                            <h3 class="text-xl font-bold" :class="result.isCorrect ? 'text-green-800' : 'text-red-800'">
                                {{ result.isCorrect ? 'Grammar is Correct!' : 'Grammar Issues Found' }}
                            </h3>
                        </div>
                        
                        <!-- Original Sentence -->
                        <div class="mb-4">
                            <h4 class="font-semibold text-gray-700 mb-2">Your sentence:</h4>
                            <p class="bg-white p-3 rounded border italic">"{{ inputSentence }}"</p>
                        </div>

                        <!-- Corrected Sentence (if applicable) -->
                        <div v-if="result.correctedSentence && !result.isCorrect" class="mb-4">
                            <h4 class="font-semibold text-gray-700 mb-2">Suggested correction:</h4>
                            <p class="bg-white p-3 rounded border">"{{ result.correctedSentence }}"</p>
                        </div>

                        <!-- Feedback -->
                        <div class="mb-4">
                            <h4 class="font-semibold text-gray-700 mb-2">Feedback:</h4>
                            <p class="text-gray-700 leading-relaxed">{{ result.feedback }}</p>
                        </div>

                        <!-- Suggestions -->
                        <div v-if="result.suggestions && result.suggestions.length > 0">
                            <h4 class="font-semibold text-gray-700 mb-2">Suggestions:</h4>
                            <ul class="space-y-2">
                                <li v-for="(suggestion, index) in result.suggestions" :key="index" 
                                    class="flex items-start gap-2 text-gray-700">
                                    <span class="text-blue-500 mt-1">‚Ä¢</span>
                                    <span>{{ suggestion }}</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Try Another Button -->
                    <button
                        @click="clearResults"
                        class="w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200"
                    >
                        Try Another Sentence
                    </button>
                </div>

                <!-- Error Message -->
                <div v-if="error" class="mt-4 p-4 bg-red-50 border-2 border-red-200 rounded-lg">
                    <div class="flex items-center gap-2">
                        <span class="text-red-500 text-xl">‚ö†Ô∏è</span>
                        <h4 class="font-semibold text-red-800">Error</h4>
                    </div>
                    <p class="text-red-700 mt-2">{{ error }}</p>
                </div>

                <!-- Instructions -->
                <div v-if="!result && !error" class="mt-8 p-6 bg-blue-50 border-2 border-blue-200 rounded-lg">
                    <h3 class="font-semibold text-blue-800 mb-3">How to use:</h3>
                    <ol class="list-decimal list-inside space-y-2 text-blue-700">
                        <li>Get your free API key from <a href="https://openrouter.ai/keys" target="_blank" class="underline">OpenRouter</a></li>
                        <li>Enter your API key above</li>
                        <li>Type any sentence you want to check</li>
                        <li>Click "Check Grammar" to get instant feedback</li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    inputSentence: '',
                    apiKey: '',
                    isLoading: false,
                    result: null,
                    error: null
                }
            },
            methods: {
                async checkGrammar() {
                    if (!this.inputSentence.trim() || !this.apiKey.trim()) {
                        this.error = 'Please enter both a sentence and your API key.';
                        return;
                    }

                    this.isLoading = true;
                    this.error = null;
                    this.result = null;

                    try {
                        const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${this.apiKey}`,
                                'Content-Type': 'application/json',
                                'HTTP-Referer': window.location.origin,
                                'X-Title': 'Grammar Study Buddy'
                            },
                            body: JSON.stringify({
                                model: 'deepseek/deepseek-chat-v3.1:free',
                                messages: [
                                    {
                                        role: 'system',
                                        content: `You are a helpful grammar tutor. When given a sentence, analyze it for grammar correctness and provide:
1. Whether the grammar is correct (true/false)
2. If incorrect, provide a corrected version
3. Brief feedback explaining the issues
4. Specific suggestions for improvement

Respond in JSON format:
{
  "isCorrect": boolean,
  "correctedSentence": "corrected version if needed",
  "feedback": "brief explanation",
  "suggestions": ["suggestion1", "suggestion2", ...]
}`
                                    },
                                    {
                                        role: 'user',
                                        content: `Please check the grammar of this sentence: "${this.inputSentence}"`
                                    }
                                ],
                                temperature: 0.3,
                                max_tokens: 500
                            })
                        });

                        if (!response.ok) {
                            throw new Error(`API request failed: ${response.status} ${response.statusText}`);
                        }

                        const data = await response.json();
                        
                        if (!data.choices || !data.choices[0] || !data.choices[0].message) {
                            throw new Error('Invalid response format from API');
                        }

                        const aiResponse = data.choices[0].message.content;
                        
                        try {
                            // Try to parse the JSON response
                            this.result = JSON.parse(aiResponse);
                        } catch (parseError) {
                            // If JSON parsing fails, create a fallback result
                            this.result = {
                                isCorrect: false,
                                correctedSentence: null,
                                feedback: aiResponse,
                                suggestions: []
                            };
                        }

                    } catch (error) {
                        console.error('Error:', error);
                        this.error = error.message || 'An unexpected error occurred. Please try again.';
                    } finally {
                        this.isLoading = false;
                    }
                },
                
                clearResults() {
                    this.result = null;
                    this.error = null;
                    this.inputSentence = '';
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
